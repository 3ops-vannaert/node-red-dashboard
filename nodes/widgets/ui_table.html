<script type="text/javascript">
    (function () {
        RED.nodes.registerType('ui-table', {
            category: RED._('@flowforge/node-red-dashboard/ui-base:ui-base.label.category'),
            color: 'rgb(119, 198, 204)',
            defaults: {
                group: { type: 'ui-group', required: true },
                name: { value: '' },
                label: { value: 'text' },
                order: { value: 0 },
                width: {
                    value: 0,
                    validate: function (v) {
                        const width = v || 0
                        const currentGroup = $('#node-input-group').val() || this.group
                        const groupNode = RED.nodes.node(currentGroup)
                        const valid = !groupNode || +width <= +groupNode.width
                        $('#node-input-size').toggleClass('input-error', !valid)
                        return valid
                    }
                },
                height: { value: 0 },
                columns: {
                    // value: [{ key: '', label: '' }]
                    value: null
                }
            },
            inputs: 1,
            outputs: 0,
            outputLabels: function () { return this.mode },
            icon: 'font-awesome/fa-table',
            paletteLabel: 'table',
            oneditprepare: function () {
                $('#node-input-size').elementSizer({
                    width: '#node-input-width',
                    height: '#node-input-height',
                    group: '#node-input-group'
                })
            }
        })
    })()
</script>

<script type="text/html" data-template-name="ui-table">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
    <div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label">
    </div>
</script>
